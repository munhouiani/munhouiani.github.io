<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"blog.munhou.com","root":"/","images":"/images","scheme":"Mist","darkmode":false,"version":"8.18.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":true,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":true,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":false,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"}}</script><script src="/js/config.js"></script>

    <meta name="description" content="LLaMA 2 Open Foundation and Fine-Tuned Chat Models📖 AbstractIn this work, we develop and release Llama 2, a collection of pretrained and ﬁne-tuned large language models (LLMs) ranging in scale from 7">
<meta property="og:type" content="article">
<meta property="og:title" content="Paper Study: LLaMA 2 Open Foundation and Fine-Tuned Chat Models">
<meta property="og:url" content="https://blog.munhou.com/2023/08/11/Paper-Study-LLaMA-2-Open-Foundation-and-Fine-Tuned-Chat-Models/index.html">
<meta property="og:site_name" content="Mun Hou&#39;s Blog">
<meta property="og:description" content="LLaMA 2 Open Foundation and Fine-Tuned Chat Models📖 AbstractIn this work, we develop and release Llama 2, a collection of pretrained and ﬁne-tuned large language models (LLMs) ranging in scale from 7">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://blog.munhou.com/images/llama2/CleanShot2023-08-09at214248.png">
<meta property="og:image" content="https://blog.munhou.com/images/llama2/CleanShot2023-08-09at215358.png">
<meta property="og:image" content="https://blog.munhou.com/images/llama2/CleanShot2023-08-09at211039.png">
<meta property="og:image" content="https://blog.munhou.com/images/llama2/CleanShot2023-08-09at225631.png">
<meta property="og:image" content="https://blog.munhou.com/images/llama2/CleanShot2023-08-09at235927.png">
<meta property="og:image" content="https://blog.munhou.com/images/llama2/CleanShot2023-08-10at001305.png">
<meta property="og:image" content="https://blog.munhou.com/images/llama2/CleanShot2023-08-09at222311.png">
<meta property="og:image" content="https://blog.munhou.com/images/llama2/CleanShot2023-08-09at222726.png">
<meta property="og:image" content="https://blog.munhou.com/images/llama2/CleanShot2023-08-09at222758.png">
<meta property="og:image" content="https://blog.munhou.com/images/llama2/CleanShot2023-08-10at231055.png">
<meta property="og:image" content="https://blog.munhou.com/images/llama2/CleanShot2023-08-10at231154.png">
<meta property="og:image" content="https://blog.munhou.com/images/llama2/CleanShot2023-08-10at231451.png">
<meta property="og:image" content="https://blog.munhou.com/images/llama2/CleanShot2023-08-11at233511.png">
<meta property="og:image" content="https://blog.munhou.com/images/llama2/CleanShot2023-08-11at233615.png">
<meta property="article:published_time" content="2023-08-11T16:08:00.000Z">
<meta property="article:modified_time" content="2023-08-14T18:55:22.335Z">
<meta property="article:author" content="Mun Hou">
<meta property="article:tag" content="Deep Learning">
<meta property="article:tag" content="Paper Study">
<meta property="article:tag" content="Large Language Model">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://blog.munhou.com/images/llama2/CleanShot2023-08-09at214248.png">


<link rel="canonical" href="https://blog.munhou.com/2023/08/11/Paper-Study-LLaMA-2-Open-Foundation-and-Fine-Tuned-Chat-Models/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"https://blog.munhou.com/2023/08/11/Paper-Study-LLaMA-2-Open-Foundation-and-Fine-Tuned-Chat-Models/","path":"2023/08/11/Paper-Study-LLaMA-2-Open-Foundation-and-Fine-Tuned-Chat-Models/","title":"Paper Study: LLaMA 2 Open Foundation and Fine-Tuned Chat Models"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Paper Study: LLaMA 2 Open Foundation and Fine-Tuned Chat Models | Mun Hou's Blog</title>
  
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-61451029-2"></script>
  <script class="next-config" data-name="google_analytics" type="application/json">{"tracking_id":"UA-61451029-2","only_pageview":false}</script>
  <script src="/js/third-party/analytics/google-analytics.js"></script>








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">Mun Hou's Blog</p>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="Search" role="button">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li>
  </ul>
</nav>




</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#LLaMA-2-Open-Foundation-and-Fine-Tuned-Chat-Models"><span class="nav-number">1.</span> <span class="nav-text">LLaMA 2 Open Foundation and Fine-Tuned Chat Models</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%F0%9F%93%96-Abstract"><span class="nav-number">1.1.</span> <span class="nav-text">📖 Abstract</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%F0%9F%8E%AF-Goal"><span class="nav-number">1.2.</span> <span class="nav-text">🎯 Goal</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%F0%9F%A4%94-Hypothesis"><span class="nav-number">1.3.</span> <span class="nav-text">🤔 Hypothesis</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%F0%9F%92%A1-Methodology"><span class="nav-number">1.4.</span> <span class="nav-text">💡 Methodology</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Pre-Training"><span class="nav-number">1.4.1.</span> <span class="nav-text">Pre-Training</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Pre-training-Data"><span class="nav-number">1.4.1.1.</span> <span class="nav-text">Pre-training Data</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Model-Architecture"><span class="nav-number">1.4.1.2.</span> <span class="nav-text">Model Architecture</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Hyperparemeters"><span class="nav-number">1.4.1.3.</span> <span class="nav-text">Hyperparemeters</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Tokenizer"><span class="nav-number">1.4.1.4.</span> <span class="nav-text">Tokenizer</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Fine-Tuned-For-Chat"><span class="nav-number">1.4.2.</span> <span class="nav-text">Fine-Tuned For Chat</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Supervised-Fine-Tuning-SFT"><span class="nav-number">1.4.2.1.</span> <span class="nav-text">Supervised Fine-Tuning (SFT)</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#SFT-Data"><span class="nav-number">1.4.2.1.1.</span> <span class="nav-text">SFT Data</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#SFT-Hyperparemeters"><span class="nav-number">1.4.2.1.2.</span> <span class="nav-text">SFT Hyperparemeters</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#SFT-Details"><span class="nav-number">1.4.2.1.3.</span> <span class="nav-text">SFT Details</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Reinforcement-Learning-with-Human-Feedback-RLHF"><span class="nav-number">1.4.2.2.</span> <span class="nav-text">Reinforcement Learning with Human Feedback (RLHF)</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#RLHF-Data"><span class="nav-number">1.4.2.2.1.</span> <span class="nav-text">RLHF Data</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#RLHF-Reward-Modeling"><span class="nav-number">1.4.2.2.2.</span> <span class="nav-text">RLHF Reward Modeling</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#RLHF-Reward-Model-Training-Details"><span class="nav-number">1.4.2.2.3.</span> <span class="nav-text">RLHF Reward Model Training Details</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#RLHF-Iterative-Fine-Tuning"><span class="nav-number">1.4.2.2.4.</span> <span class="nav-text">RLHF Iterative Fine-Tuning</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#RLHF-Iterative-Fine-Tuning-Training-Details"><span class="nav-number">1.4.2.2.5.</span> <span class="nav-text">RLHF Iterative Fine-Tuning Training Details</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Ghost-Attention-for-Multi-Turn-Consistency"><span class="nav-number">1.4.2.3.</span> <span class="nav-text">Ghost Attention for Multi-Turn Consistency</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%F0%9F%93%8A-Result-s"><span class="nav-number">1.5.</span> <span class="nav-text">📊 Result(s)</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Pre-Training-1"><span class="nav-number">1.5.1.</span> <span class="nav-text">Pre-Training</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Training-Loss"><span class="nav-number">1.5.1.1.</span> <span class="nav-text">Training Loss</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Benchmarks"><span class="nav-number">1.5.1.2.</span> <span class="nav-text">Benchmarks</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Fine-Tuned-For-Chat-1"><span class="nav-number">1.5.2.</span> <span class="nav-text">Fine-Tuned For Chat</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Reward-Model-Results"><span class="nav-number">1.5.2.1.</span> <span class="nav-text">Reward Model Results</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Evolution-of-Harmlessness"><span class="nav-number">1.5.2.2.</span> <span class="nav-text">Evolution of Harmlessness</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Human-Evaluation"><span class="nav-number">1.5.2.3.</span> <span class="nav-text">Human Evaluation</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%F0%9F%94%91-Summary-of-Key-Points"><span class="nav-number">1.6.</span> <span class="nav-text">🔑 Summary of Key Points</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E2%9D%97-Significance"><span class="nav-number">1.7.</span> <span class="nav-text">❗ Significance</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%F0%9F%92%AC-Other-Comments"><span class="nav-number">1.8.</span> <span class="nav-text">💬 Other Comments</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%F0%9F%99%8B%E2%80%8D%E2%99%82%EF%B8%8F-Questions-and-Answers"><span class="nav-number">1.9.</span> <span class="nav-text">🙋‍♂️ Questions and Answers</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Mun Hou</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">16</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">11</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/munhouiani" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;munhouiani" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:munhou2022+blog@gmail.com" title="E-Mail → mailto:munhou2022+blog@gmail.com" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="https://blog.munhou.com/2023/08/11/Paper-Study-LLaMA-2-Open-Foundation-and-Fine-Tuned-Chat-Models/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Mun Hou">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Mun Hou's Blog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="Paper Study: LLaMA 2 Open Foundation and Fine-Tuned Chat Models | Mun Hou's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Paper Study: LLaMA 2 Open Foundation and Fine-Tuned Chat Models
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2023-08-12 00:08:00" itemprop="dateCreated datePublished" datetime="2023-08-12T00:08:00+08:00">2023-08-12</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-08-15 02:55:22" itemprop="dateModified" datetime="2023-08-15T02:55:22+08:00">2023-08-15</time>
    </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus: </span>
    
    <a title="disqus" href="/2023/08/11/Paper-Study-LLaMA-2-Open-Foundation-and-Fine-Tuned-Chat-Models/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2023/08/11/Paper-Study-LLaMA-2-Open-Foundation-and-Fine-Tuned-Chat-Models/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><h1 id="LLaMA-2-Open-Foundation-and-Fine-Tuned-Chat-Models"><a href="#LLaMA-2-Open-Foundation-and-Fine-Tuned-Chat-Models" class="headerlink" title="LLaMA 2 Open Foundation and Fine-Tuned Chat Models"></a>LLaMA 2 Open Foundation and Fine-Tuned Chat Models</h1><h2 id="📖-Abstract"><a href="#📖-Abstract" class="headerlink" title="📖 Abstract"></a>📖 Abstract</h2><p>In this work, we develop and release Llama 2, a collection of pretrained and ﬁne-tuned large language models (LLMs) ranging in scale from 7 billion to 70 billion parameters. Our ﬁne-tuned LLMs, called LLaMA 2-Chat are optimized for dialogue use cases. Our models outperform open-source chat models on most benchmarks we tested, and based on our human evaluations for helpfulness and safety, may be a suitable substitute for closedsource models. We provide a detailed description of our approach to ﬁne-tuning and safety improvements of LLaMA 2-Chat in order to enable the community to build on our work and contribute to the responsible development of LLMs.</p>
<span id="more"></span>

<h2 id="🎯-Goal"><a href="#🎯-Goal" class="headerlink" title="🎯 Goal"></a>🎯 Goal</h2><ul>
<li>Develop and release LLaMA 2, a pre-trained foundation language model, and a fine-tuned language model, LLaMA 2-Chat</li>
</ul>
<h2 id="🤔-Hypothesis"><a href="#🤔-Hypothesis" class="headerlink" title="🤔 Hypothesis"></a>🤔 Hypothesis</h2><ul>
<li>With sufficient scale, computing, and techniques to align with human preferences, it is possible to create large language models comparable in quality to closed-source chatbots through an open research process.</li>
</ul>
<h2 id="💡-Methodology"><a href="#💡-Methodology" class="headerlink" title="💡 Methodology"></a>💡 Methodology</h2><h3 id="Pre-Training"><a href="#Pre-Training" class="headerlink" title="Pre-Training"></a>Pre-Training</h3><ul>
<li>Using a similar pre-training method as LlaMA 1, except for the following differences:</li>
</ul>
<img src="/images/llama2/CleanShot2023-08-09at214248.png" width=500px/>

<h4 id="Pre-training-Data"><a href="#Pre-training-Data" class="headerlink" title="Pre-training Data"></a>Pre-training Data</h4><ul>
<li>They used a new mix of data from publicly available sources,  including web pages, books, Wikipedia, forums, and other text-based sites, but didn’t mention the exact sources.</li>
<li>They excluded data from certain sites known to contain high volumes of personal information about private individuals.</li>
<li>The training corpus has 2 trillion tokens.</li>
<li>The majority of the data is in English:  <img src="/images/llama2/CleanShot2023-08-09at215358.png" width=500px/></li>
<li>The data has a cutoff of September 2022.</li>
<li>The data was collected adhering to standard privacy and legal reviews and includes no private Meta user data.</li>
</ul>
<h4 id="Model-Architecture"><a href="#Model-Architecture" class="headerlink" title="Model Architecture"></a>Model Architecture</h4><ul>
<li>Adopt most of the pretraining setting from Llama1<ul>
<li>Standard Transformer architecture</li>
<li>Apply RMSNorm</li>
<li>Use SwiGLU activation function</li>
<li>Use RoPE</li>
</ul>
</li>
<li>Increase context length to <strong>4096</strong> tokens</li>
<li>Use grouped-query attention (GQA)</li>
</ul>
<h4 id="Hyperparemeters"><a href="#Hyperparemeters" class="headerlink" title="Hyperparemeters"></a>Hyperparemeters</h4><ul>
<li>Used AdamW optimizer<ul>
<li>$\beta_1 &#x3D; 0.9$</li>
<li>$\beta_2 &#x3D; 0.95$</li>
<li>$\epsilon &#x3D; 10^{-5}$</li>
<li>Cosine learning rate schedule, with a warmup of 2000 steps, and decay final learning rate down to 10% of the peak learning rate.</li>
<li>Use weight decay of 0.1</li>
<li>Use gradient clipping of 1.0</li>
</ul>
</li>
</ul>
<h4 id="Tokenizer"><a href="#Tokenizer" class="headerlink" title="Tokenizer"></a>Tokenizer</h4><ul>
<li>Same tokenizer as Llama1</li>
<li>use <a href="/2023/08/14/Byte-Pair-Encoding-BPE/" title="Byte-Pair-Encoding (BPE)">BPE</a></li>
<li>The total vocabulary size is 32K tokens.</li>
</ul>
<h3 id="Fine-Tuned-For-Chat"><a href="#Fine-Tuned-For-Chat" class="headerlink" title="Fine-Tuned For Chat"></a>Fine-Tuned For Chat</h3><img src="/images/llama2/CleanShot2023-08-09at211039.png" width=500px/>

<h4 id="Supervised-Fine-Tuning-SFT"><a href="#Supervised-Fine-Tuning-SFT" class="headerlink" title="Supervised Fine-Tuning (SFT)"></a>Supervised Fine-Tuning (SFT)</h4><h5 id="SFT-Data"><a href="#SFT-Data" class="headerlink" title="SFT Data"></a>SFT Data</h5><ul>
<li>Annotated 27,540 supervised fine-tuning datasets.</li>
<li>SFT annotations in the order of <strong>tens of thousands</strong> were enough to achieve a high-quality result. </li>
<li>Each sample consists of a prompt and an answer.</li>
<li>To annotate samples for safety, they asked human annotators to create adversarial prompts along two dimensions: a <em>risk category</em>, or potential topic about which the LLM could produce unsafe content, and an <em>attack vector</em>, or question style to cover different varieties of prompts that could elicit bad model behaviors.<ul>
<li>Three risk categories:<ol>
<li><em>Illicit and criminal activities</em> (e.g., terrorism, theft, human trafficking)</li>
<li><em>Hateful and harmful activities</em> (e.g., defamation, self-harm, eating disorders, discrimination)</li>
<li><em>Unqualified advice</em> (e.g., medical advice, financial advice, legal advice)</li>
</ol>
</li>
<li>Example of attack vector:<ul>
<li><em>psychological manipulation</em> (e.g., authority manipulation)</li>
<li><em>logic manipulation</em> (e.g., false premises)</li>
<li><em>syntactic manipulation</em> (e.g., misspelling)</li>
<li><em>semantic manipulation</em> (e.g., metaphor)</li>
<li><em>perspective manipulation</em> (e.g., role-playing)</li>
<li><em>non-English languages</em></li>
</ul>
</li>
</ul>
</li>
<li>They defined best practices for safe and helpful model responses: <ol>
<li>The model should ﬁrst address immediate safety concerns if applicable.</li>
<li>Then, address the prompt by explaining the potential risks to the user.</li>
<li>Finally, provide additional information if possible.</li>
</ol>
</li>
<li>They observed that a few thousand safety-related samples were enough for SFT.</li>
<li>Example of SFT annotation:  <img src="/images/llama2/CleanShot2023-08-09at225631.png" width=500px/></li>
</ul>
<h5 id="SFT-Hyperparemeters"><a href="#SFT-Hyperparemeters" class="headerlink" title="SFT Hyperparemeters"></a>SFT Hyperparemeters</h5><ul>
<li>Use cosine learning rate schedule</li>
<li>Use an initial learning rate of $2 \times 10^{-5}$</li>
<li>Use weight decay of 0.1</li>
<li>Use a batch size of 64</li>
<li>The sequence length is 4096 tokens.</li>
<li>2 epochs.</li>
</ul>
<h5 id="SFT-Details"><a href="#SFT-Details" class="headerlink" title="SFT Details"></a>SFT Details</h5><ul>
<li>Concatenate all the prompts and answers from the training set to ensure the model sequence length is properly filled.</li>
<li>Use a special token to separate the prompt and answer segments.</li>
<li>Use an autoregressive objective.</li>
<li>Zero out the loss on tokens from the user prompt, only back-propagate on answer tokens.</li>
</ul>
<h4 id="Reinforcement-Learning-with-Human-Feedback-RLHF"><a href="#Reinforcement-Learning-with-Human-Feedback-RLHF" class="headerlink" title="Reinforcement Learning with Human Feedback (RLHF)"></a>Reinforcement Learning with Human Feedback (RLHF)</h4><h5 id="RLHF-Data"><a href="#RLHF-Data" class="headerlink" title="RLHF Data"></a>RLHF Data</h5><ul>
<li>Ask annotators to write a prompt first, then choose between two sampled model responses based on the provided criteria.<ul>
<li>Two responses are sampled from two different model variants and varying the temperature hyper-parameter.</li>
</ul>
</li>
<li>Asked annotators also to label the degree to which they prefer their chosen response over the alternative: <em>significantly better</em>, <em>better</em>, <em>slightly better</em>, or <em>negligibly better &#x2F; unsure</em>.</li>
<li>Asked annotators to label model responses into one of three categories: <em>1) the preferred response is safe and the other response is not</em>, <em>2) both responses are safe</em>, and <em>3) both responses are unsafe</em>. They <em><strong>didn’t</strong></em> use samples where the chosen response was unsafe and the other was safe.</li>
<li>These data are used to train two reward models: <em>Helpfulness RM</em>, optimized for helpfulness, and <em>Safety RM</em>, optimized for safety.</li>
<li>Human annotations were collected in batches on a weekly basis.</li>
<li>They collected over <em><strong>1 million</strong></em> binary comparisons by humans and have longer, more conversation turns. See the comparison against open datasets:  <img src="/images/llama2/CleanShot2023-08-09at235927.png" width=500px/></li>
</ul>
<h5 id="RLHF-Reward-Modeling"><a href="#RLHF-Reward-Modeling" class="headerlink" title="RLHF Reward Modeling"></a>RLHF Reward Modeling</h5><ul>
<li>Trained two reward models: <strong>Helpfulness RM</strong>, optimized for helpfulness, and <strong>Safety RM</strong>, optimized for safety.</li>
<li>They initialized both reward models from pre-trained chat model checkpoints to ensure that both models benefit from the knowledge acquired in pre-training.</li>
<li>Model architecture and hyper-parameters are identical to the pre-trained language models, except that the classification head for next-token prediction is replaced with a regression head for outputting a scalar reward.</li>
<li>The training objective is binary ranking loss, enforcing the chosen response to score higher than its counterpart:<br>$$<br>\operatorname{Loss_{\text{ranking}}} &#x3D; -\log(\sigma(r_{\theta}(x, y_c) - r_{\theta}(x, y_r) - m(r)))<br>$$</li>
<li>Where $r_{\theta}(x, y)$ is the scalar score output for prompt $x$ and completion $y$ with model weights $\theta$. $y_c$ is the preferred response and $y_r$ is the rejected counterpart. The margin $m(r)$ is a discrete function of the preference rating.  </li>
<li>They use a large margin for pairs with distinct responses and a smaller one for those with similar responses. There are two variants for setting the margin function. See the table below.  <img src="/images/llama2/CleanShot2023-08-10at001305.png" width=500px/></li>
<li>The final training data composition for both reward models:<ul>
<li><strong>Helpfulness RM</strong>:<ul>
<li>All Meta Helpfulness data</li>
<li>Equal parts of the remaining data were uniformly sampled from Meta Safety and the open-source datasets.</li>
</ul>
</li>
<li><strong>Safety RM</strong>:<ul>
<li>All Meta Safety data</li>
<li>All Anthropic Harmless data</li>
<li>Mixed with Meta Helpfulness and open-source helpfulness data in a 90&#x2F;10 proportion.</li>
</ul>
</li>
</ul>
</li>
</ul>
<h5 id="RLHF-Reward-Model-Training-Details"><a href="#RLHF-Reward-Model-Training-Details" class="headerlink" title="RLHF Reward Model Training Details"></a>RLHF Reward Model Training Details</h5><ul>
<li>Train for one epoch over the training data</li>
<li>Use the same optimizer parameters as for the base model:<ul>
<li>Used AdamW optimizer<ul>
<li>$\beta_1 &#x3D; 0.9$</li>
<li>$\beta_2 &#x3D; 0.95$</li>
<li>$\epsilon &#x3D; 10^{-5}$</li>
<li>Cosine learning rate schedule, with a warmup step of 3% of the total number of steps, with a minimum of 5 warmup steps, and decay final learning rate down to 10% of the peak learning rate.</li>
<li>Use weight decay of 0.1</li>
<li>Use gradient clipping of 1.0</li>
</ul>
</li>
</ul>
</li>
<li>The maximum learning rate is $5 \times 10^{-6}$ for the 70B parameter LLaMA 2-Chat, and $1 \times 10^{-5}$ for the rest.</li>
<li>The batch size is kept fixed at 512 pairs, or 1024 rows per batch.</li>
</ul>
<h5 id="RLHF-Iterative-Fine-Tuning"><a href="#RLHF-Iterative-Fine-Tuning" class="headerlink" title="RLHF Iterative Fine-Tuning"></a>RLHF Iterative Fine-Tuning</h5><ul>
<li>They trained 5 successive versions for RLHF models, referred to here as <em>RLHF-V1</em>, <em>RLHF-V2</em>, <em>RLHF-V3</em>, <em>RLHF-V4</em>, <em>RLHF-V5</em> </li>
<li>They fine-tuned the models with:<ul>
<li><a href="/2023/03/01/Proximal-Policy-Optimization-Algorithms-PPO-and-PPO2/" title="Proximal Policy Optimization Algorithms (PPO and PPO2)">Proximal Policy Optimization Algorithms</a> (<a href="/2023/03/01/Proximal-Policy-Optimization-Algorithms-PPO-and-PPO2/" title="Proximal Policy Optimization Algorithms (PPO and PPO2)">PPO</a>)</li>
<li>Rejection Sampling fine-tuning<ul>
<li>The model samples K candidate responses for each prompt in the RLHF dataset.</li>
<li>The reward models score these <em>K</em> responses.</li>
<li>The response with the highest reward score is selected as the “best” response for that prompt.</li>
<li>The prompts and their corresponding best responses selected via rejection sampling comprise a new training set.</li>
<li>The model is then trained to reinforce the responses that receive high reward scores.</li>
</ul>
</li>
</ul>
</li>
<li>Rejection sampling is only done with the 70B LLaMA 2-Chat. All smaller models are fine-tuned on rejection sampled data from the larger model.</li>
<li>The new training set in each iteration includes the rejection-sampled data from the current iteration and top-performing samples from all prior iterations.</li>
<li>Until <em>RLHF-V4</em>, they used only Rejection Sampling fine-tuning. After that, they first applied Rejection Sampling, then applied <a href="/2023/03/01/Proximal-Policy-Optimization-Algorithms-PPO-and-PPO2/" title="Proximal Policy Optimization Algorithms (PPO and PPO2)">PPO</a> on top of the resulting Rejection Sampling checkpoint before sampling again.</li>
<li>The reward function they use in the <a href="/2023/03/01/Proximal-Policy-Optimization-Algorithms-PPO-and-PPO2/" title="Proximal Policy Optimization Algorithms (PPO and PPO2)">PPO</a> is:</li>
</ul>
<p>$$<br>R(g | p) &#x3D; \tilde{R_c}(g|p) - \beta D_{KL}(\pi_{\theta}(g|p) || \pi_0(g|p))<br>$$</p>
<ul>
<li>Where $\pi_0$ is the original policy. $R_c$ is the piecewise combination of safety ($R_s$) and helpfulness ($R_h$) reward models:</li>
</ul>
<p>$$<br>\begin{align}<br>R_c(g|p) &amp;&#x3D;<br>\begin{cases}<br>R_s(g|p)  &amp; \text{if $\operatorname{IS\_SAFETY}(p)$ or $R_s(g|p) &lt; 0.15$} \\<br>R_h(g|p) &amp; \text{otherwise}<br>\end{cases} \\<br>\tilde{R_c}(g|p) &amp;&#x3D; \operatorname{WHITEN}(\operatorname{LOGIT}(R_c(g|p)))<br>\end{align}<br>$$</p>
<h5 id="RLHF-Iterative-Fine-Tuning-Training-Details"><a href="#RLHF-Iterative-Fine-Tuning-Training-Details" class="headerlink" title="RLHF Iterative Fine-Tuning Training Details"></a>RLHF Iterative Fine-Tuning Training Details</h5><ul>
<li>Used AdamW optimizer<ul>
<li>$\beta_1 &#x3D; 0.9$</li>
<li>$\beta_2 &#x3D; 0.95$</li>
<li>$\epsilon &#x3D; 10^{-5}$</li>
<li>Use a constant learning rate of $10^{-6}$</li>
<li>Use weight decay of 0.1</li>
<li>Use gradient clipping of 1.0</li>
</ul>
</li>
<li>For each <a href="/2023/03/01/Proximal-Policy-Optimization-Algorithms-PPO-and-PPO2/" title="Proximal Policy Optimization Algorithms (PPO and PPO2)">PPO</a> operation, they:<ul>
<li>Use a batch size of 512</li>
<li>Use a <a href="/2023/03/01/Proximal-Policy-Optimization-Algorithms-PPO-and-PPO2/" title="Proximal Policy Optimization Algorithms (PPO and PPO2)">PPO</a> clip threshold of 0.2</li>
<li>Use a mini-batch size of 64</li>
<li>Take 1 gradient step per mini-batch</li>
<li>They set the $\beta &#x3D; 0.01$ (KL penalty) for 7B and 13B models, and $\beta &#x3D; 0.005$ for the 34B and 70B models.</li>
</ul>
</li>
<li>They trained all the models for between 200 and 400 iterations and used evaluations on held-out prompts for early stopping.</li>
</ul>
<h4 id="Ghost-Attention-for-Multi-Turn-Consistency"><a href="#Ghost-Attention-for-Multi-Turn-Consistency" class="headerlink" title="Ghost Attention for Multi-Turn Consistency"></a>Ghost Attention for Multi-Turn Consistency</h4><ul>
<li>They observed that LLaMA-2 Chat tended to forget the initial instruction (e.g., system prompt) after a few turns of dialog.</li>
<li>They introduced Ghost Attention (GAtt) to solve this problem.</li>
<li>GAtt augments the training data to “hack” the model’s attention mechanism.</li>
<li>Key attributes or instructions that should persist across a multi-turn conversation are concatenated to every user turn in the conversation during training.</li>
<li>For example, an instruction like “Act as a doctor” would be appended to each user utterance.</li>
<li>This forces the model to attend to those attributes when generating each assistant response.</li>
<li>However, when fine-tuning the model, the loss is set to 0 for those appended tokens, so they are not predicted.</li>
<li>So the attributes&#x2F;instructions are like “ghosts” during training - not predicted but forced to be attended to.</li>
<li>This causes the model to learn to focus attention on those key attributes throughout the conversation, even when they are no longer appended at inference time.</li>
<li>As a result, the model is more consistent about following the instructions or maintaining persona&#x2F;character throughout multiple turns.</li>
</ul>
<h2 id="📊-Result-s"><a href="#📊-Result-s" class="headerlink" title="📊 Result(s)"></a>📊 Result(s)</h2><h3 id="Pre-Training-1"><a href="#Pre-Training-1" class="headerlink" title="Pre-Training"></a>Pre-Training</h3><h4 id="Training-Loss"><a href="#Training-Loss" class="headerlink" title="Training Loss"></a>Training Loss</h4><img src="/images/llama2/CleanShot2023-08-09at222311.png" width=500px/>

<h4 id="Benchmarks"><a href="#Benchmarks" class="headerlink" title="Benchmarks"></a>Benchmarks</h4><img src="/images/llama2/CleanShot2023-08-09at222726.png" width=500px/>

<img src="/images/llama2/CleanShot2023-08-09at222758.png" width=500px/>

<h3 id="Fine-Tuned-For-Chat-1"><a href="#Fine-Tuned-For-Chat-1" class="headerlink" title="Fine-Tuned For Chat"></a>Fine-Tuned For Chat</h3><h4 id="Reward-Model-Results"><a href="#Reward-Model-Results" class="headerlink" title="Reward Model Results"></a>Reward Model Results</h4><img src="/images/llama2/CleanShot2023-08-10at231055.png" width=500px/>

<img src="/images/llama2/CleanShot2023-08-10at231154.png" width=500px/>

<img src="/images/llama2/CleanShot2023-08-10at231451.png" width=500px/>

<h4 id="Evolution-of-Harmlessness"><a href="#Evolution-of-Harmlessness" class="headerlink" title="Evolution of Harmlessness"></a>Evolution of Harmlessness</h4><img src="/images/llama2/CleanShot2023-08-11at233511.png" width=500px/>

<h4 id="Human-Evaluation"><a href="#Human-Evaluation" class="headerlink" title="Human Evaluation"></a>Human Evaluation</h4><img src="/images/llama2/CleanShot2023-08-11at233615.png" width=500px/>

<h2 id="🔑-Summary-of-Key-Points"><a href="#🔑-Summary-of-Key-Points" class="headerlink" title="🔑 Summary of Key Points"></a>🔑 Summary of Key Points</h2><ul>
<li>Pretrain large auto-regressive language models LLaMA 2 using publicly available data at scales up to 70B parameters, with optimizations like longer context and grouped query attention</li>
<li>Apply supervised fine-tuning (SFT) on high-quality human annotations for initializing helpful and safe models </li>
<li>Use reinforcement learning with human feedback (RLHF) to iteratively improve models by learning from human preferences</li>
<li>Propose techniques like rejection sampling, targeted context distillation, and Ghost Attention to enhance multi-turn dialogue capabilities </li>
<li>Conduct detailed investigations into pretraining data distributions and model capabilities to enable transparency</li>
<li>Share analysis of carbon emissions from pretraining and steps taken to increase efficiency and offset costs</li>
<li>Demonstrate with human evaluations that Llama 2-Chat models are comparable to closed-source chatbots like ChatGPT</li>
<li>Discuss techniques to mitigate risks identified through red teaming and limitations of current benchmark evaluations</li>
<li>Release Llama 2 openly, along with documentation to encourage reproducible research into aligning large language models</li>
<li>Argue that an open research approach with sufficient resources can produce models rivaling closed-source systems, supporting the decentralization of AI capabilities</li>
</ul>
<h2 id="❗-Significance"><a href="#❗-Significance" class="headerlink" title="❗ Significance"></a>❗ Significance</h2><ul>
<li>Demonstrates the viability of an open research approach to developing helpful and safe conversational AI systems comparable to closed-source chatbots.</li>
<li>Provides extensive documentation of techniques, data, and findings to enable transparency and reproducibility of aligning large language models.</li>
<li>Shares detailed analysis and mitigation strategies for safety risks in dialogue systems identified through red teaming.</li>
<li>Introduces optimizations like grouped query attention and Ghost Attention that improve scalability and multi-turn consistency in large models.</li>
<li>Analyzes trends in scaling model size, data, and computing to guide efficient training of future systems.</li>
<li>Discusses techniques to balance safety with open-domain performance through targeted data collection and fine-tuning.</li>
<li>Encourages responsible and transparent release of foundational AI models to increase access and allow decentralized innovation.</li>
<li>Reveals interesting observations about emergent behaviors like tool usage and temporal reasoning in aligned models.</li>
<li>Provides benchmarks and insights to advance research into evaluating dialogue systems through automatic metrics and human studies.</li>
<li>Highlights techniques to reduce the carbon footprint of model development and calls for sustainability practices.</li>
<li>Argues the importance of cross-disciplinary collaboration between researchers, policymakers, and civil society to guide the development of AI technologies.</li>
</ul>
<h2 id="💬-Other-Comments"><a href="#💬-Other-Comments" class="headerlink" title="💬 Other Comments"></a>💬 Other Comments</h2><ul>
<li>The safety techniques and red teaming process set a transparent and proactive risk mitigation standard. More details on the evolution of robustness during red teaming could further knowledge sharing.</li>
<li>The human evaluations provide a useful snapshot, but long-term studies are needed to characterize real-world impacts after deployment.</li>
<li>Discussing tensions between safety and capabilities highlights important open challenges in aligning models without reducing usefulness.</li>
<li>More analysis of the developed techniques on languages beyond English could better reveal multilingual issues and opportunities.</li>
</ul>
<h2 id="🙋‍♂️-Questions-and-Answers"><a href="#🙋‍♂️-Questions-and-Answers" class="headerlink" title="🙋‍♂️ Questions and Answers"></a>🙋‍♂️ Questions and Answers</h2><p><strong>Q</strong>: How was Llama 2 pretrained?<br><strong>A</strong>: Llama 2 was pretrained on 2 trillion tokens of publicly available data. The architecture uses an optimized transformer with improvements like a longer context length of 4k and grouped query attention for larger models. It was trained using AdamW optimization and checkpoint averaging.</p>
<p><strong>Q</strong>: What techniques were used to create the helpful and safe Llama 2-Chat models?<br><strong>A</strong>: The authors used supervised fine-tuning (SFT) on high-quality human annotations to bootstrap. This was followed by iterative reinforcement learning with human feedback (RLHF) using preference learning and <a href="/2023/03/01/Proximal-Policy-Optimization-Algorithms-PPO-and-PPO2/" title="Proximal Policy Optimization Algorithms (PPO and PPO2)">PPO</a> to align the models with human preferences on helpfulness and safety. Techniques like rejection sampling, targeted context distillation, and Ghost Attention were also used.</p>
<p><strong>Q</strong>: How were the safety capabilities of Llama 2 measured?<br><strong>A</strong>: The safety of Llama 2 was measured through automatic benchmarks for truthfulness, toxicity, and bias, as well as human evaluations on adversarial prompts. Red teaming exercises were also conducted. The authors share a detailed analysis of aspects like pronoun usage, identity terms, and toxicity in the pretraining data.</p>
<p><strong>Q</strong>: What were some key observations made during the development of Llama 2-Chat?<br><strong>A</strong>: Some observations include RLHF outperforming supervised tuning, the model learning to temporally organize knowledge and call APIs for tool usage with minimal examples, and the need to adjust temperature during iterative RLHF.</p>
<p><strong>Q</strong>: What are some limitations of the human evaluations conducted?<br><strong>A</strong>: Limitations include the subjectivity of reviews, the scope of the prompt set, limiting generations to 1k tokens for some models, and assessing only final generations for conversations. Evaluations may also be biased towards the Llama 2-Chat models.</p>
<p><strong>Q</strong>: How was the release strategy designed to be responsible?<br><strong>A</strong>: The authors performed extensive tuning focused on safety, shared detailed documentation to enable reproducibility and safety improvements, provided a responsible use guide, and released the models openly to enable innovation and reduce barriers.</p>
<p><strong>Q</strong>: How were the reward models for RLHF trained and evaluated?<br><strong>A</strong>: Using human preference data, separate reward models were trained for safety and helpfulness. The models were evaluated on held-out sets and benchmark datasets. Techniques like margin loss and auxiliary safety loss improved accuracy.</p>
<p><strong>Q</strong>: What mitigation strategies were used to improve model safety?<br><strong>A</strong>: Strategies included safety-focused SFT, targeted safety RLHF, context distillation with safety preprompts, rejection sampling to avoid unsafe responses, and using the safety reward model to choose whether to apply context distillation.</p>
<p><strong>Q</strong>: What analysis was done on model bias during pretraining?<br><strong>A</strong>: The analysis looked at pronoun usage, identity terms, and toxicity in the pretrained data. The authors found some skews, like fewer she pronouns and Western-centric identities, that could lead to biased generations.</p>
<p><strong>Q</strong>: How were human annotations collected and validated?<br><strong>A</strong>: Annotations were collected from trained annotators following detailed guidelines. A quality assurance process manually reviewed annotations before model training. Curriculum strategies were used to improve annotation quality.</p>
<p><strong>Q</strong>: What limitations remain in the Llama 2 models?<br><strong>A</strong>: Limitations include lack of ongoing knowledge updates, potential for hallucinations, limitations in non-English languages, and risk of overly cautious responses due to safety tuning.</p>
<p><strong>Q</strong>: What were some key results comparing Llama 2 to other models?<br><strong>A</strong>: Llama 2 outperformed open-source models like LLaMa, Falcon, and MPT on benchmarks. The 70B model was competitive with closed models like GPT-3 on some tasks. There are still significant gaps compared to very large models like GPT-4.</p>
<p><strong>Q</strong>: How does the context length compare to other recent models? What was its impact?<br><strong>A</strong>: Llama 2 uses a 4k context length, compared to 2k in Llama 1 and often &lt;2k in other models. This improved performance on long-context tasks like summarization while maintaining strong results on other tasks.</p>
<p><strong>Q</strong>: What techniques were used to scale up training and inference?<br><strong>A</strong>: Checkpoint averaging, mixed precision, tensor parallelism, and optimizations like grouped query attention enabled scaling up training. Caching optimizations improved inference latency.</p>
<p><strong>Q</strong>: How was the carbon footprint of pretraining calculated? What steps were taken to reduce it?<br><strong>A</strong>: Emissions were estimated based on GPU usage and emissions factors. Total emissions were 539 tCO2eq and fully offset. Compute and energy efficiency techniques reduced emissions, as did open release to avoid repeat training costs.</p>
<p><strong>Q</strong>: What steps could be taken to improve Llama 2-Chat further?<br><strong>A</strong>: Additional tuning focused on non-English languages, handling tools&#x2F;APIs, maintaining context over more turns, improving factual accuracy, and balancing safety with open-domain capabilities. More comprehensive evaluations post-deployment would also be beneficial.</p>
<p><strong>Q</strong>: What safety risks were identified through red teaming exercises?<br><strong>A</strong>: Red teaming identified risks like providing dangerous advice when embedded in positive framing, distraction with creative prompts, responding dangerously despite initial reluctance, and non-English attack vectors.</p>
<p><strong>Q</strong>: How were the human evaluations conducted? What were the limitations?<br><strong>A</strong>: Humans-rated model outputs from Llama 2-Chat and other models. Limitations included subjectivity, scope&#x2F;diversity of the prompt set, and assessing only final turns for conversations.</p>
<p><strong>Q</strong>: How does the contamination analysis account for the fragmentation of overlaps?<br><strong>A</strong>: The analysis looks for long, contiguous matches between evaluation and training data to avoid fragmentation. It tries multiple minimum match lengths and reports the longest that shows evidence of contamination.</p>
<p><strong>Q</strong>: What techniques were used to improve multi-turn capabilities? How were they evaluated?<br><strong>A</strong>: Ghost Attention (GAtt) was proposed to help the model attend to key prompt attributes over multiple turns. GAtt improved consistency in human evaluations up to 20 turns.</p>
<p><strong>Q</strong>: What steps were taken to enable reproducible release and research?<br><strong>A</strong>: The authors released full model details, training methodology, evaluation data, code examples, a responsible use guide, and a discussion of limitations to enable reproducibility and safe deployment.</p>
<p><strong>Q</strong>: What was the motivation behind releasing Llama 2 openly?<br><strong>A</strong>: The authors aimed to encourage responsible AI innovation, draw on community wisdom for improving safety, increase access to foundational models, and consolidate costs so others don’t repeat expensive training.</p>
<p><strong>Q</strong>: How does the helpfulness annotation process differ from existing datasets?<br><strong>A</strong>: High-quality annotation focusing on dialogue was prioritized over scale, with only tens of thousands of examples needed. Annotators compared model samples rather than provided demonstrations.</p>
<p><strong>Q</strong>: What techniques mitigated forgetting during iterative RLHF?<br><strong>A</strong>: Using top samples from all prior iterations rather than just the latest helped avoid losing capabilities from previous versions.</p>
<p><strong>Q</strong>: How did the authors balance safety and open-domain performance?<br><strong>A</strong>: By prefacing prompts when collecting unsafe demonstrations for SFT, safety could be taught without reducing capabilities. Targeted RLHF focused on safety also avoided regressing open-domain performance.</p>
<p><strong>Q</strong>: What analyses were done to characterize the training data?<br><strong>A</strong>: Analyses examined language distributions, demographic representations based on pronouns and identity terms, and toxicity levels using classifier scores.</p>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Deep-Learning/" rel="tag"># Deep Learning</a>
              <a href="/tags/Paper-Study/" rel="tag"># Paper Study</a>
              <a href="/tags/Large-Language-Model/" rel="tag"># Large Language Model</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2023/08/10/Paper-Study-LLaMA-Open-and-Ef%EF%AC%81cient-Foundation-Language-Models/" rel="prev" title="Paper Study: LLaMA Open and Efﬁcient Foundation Language Models">
                  <i class="fa fa-angle-left"></i> Paper Study: LLaMA Open and Efﬁcient Foundation Language Models
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2023/08/14/Byte-Pair-Encoding-BPE/" rel="next" title="Byte-Pair-Encoding (BPE)">
                  Byte-Pair-Encoding (BPE) <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






    
  <div class="comments" id="disqus_thread">
    <noscript>Please enable JavaScript to view the comments powered by Disqus.</noscript>
  </div>
  
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2023</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">Mun Hou</span>
  </div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/mist/" rel="noopener" target="_blank">NexT.Mist</a>
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>

  <a href="https://github.com/munhouiani" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script><script src="/js/bookmark.js"></script>

  






  




  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"all","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>


<script class="next-config" data-name="disqus" type="application/json">{"enable":true,"shortname":"munhousblog","count":true,"i18n":{"disqus":"disqus"}}</script>
<script src="/js/third-party/comments/disqus.js"></script>

</body>
</html>
